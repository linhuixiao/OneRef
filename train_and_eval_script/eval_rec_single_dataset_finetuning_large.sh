# eval :
# RefCOCO unc
CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python -m torch.distributed.launch --nproc_per_node=8 --master_port 28888 --use_env eval.py --num_workers 4 --batch_size 128  --imsize 384 --max_query_len 64 --model beit3_large_patch16_384 --task grounding --dataset unc      --eval_set val   --data_root /patch_to_image_data --split_root /path_to/ref_data_shuffled/single_dataset --eval_model /path_to/oneref/rec_single_dataset_finetuning_large/unc/best_checkpoint.pth      --output_dir /path_to/oneref/rec_single_dataset_finetuning_large/unc;
CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python -m torch.distributed.launch --nproc_per_node=8 --master_port 28888 --use_env eval.py --num_workers 4 --batch_size 128  --imsize 384 --max_query_len 64 --model beit3_large_patch16_384 --task grounding --dataset unc      --eval_set testA --data_root /patch_to_image_data --split_root /path_to/ref_data_shuffled/single_dataset --eval_model /path_to/oneref/rec_single_dataset_finetuning_large/unc/best_checkpoint.pth      --output_dir /path_to/oneref/rec_single_dataset_finetuning_large/unc;
CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python -m torch.distributed.launch --nproc_per_node=8 --master_port 28888 --use_env eval.py --num_workers 4 --batch_size 128  --imsize 384 --max_query_len 64 --model beit3_large_patch16_384 --task grounding --dataset unc      --eval_set testB --data_root /patch_to_image_data --split_root /path_to/ref_data_shuffled/single_dataset --eval_model /path_to/oneref/rec_single_dataset_finetuning_large/unc/best_checkpoint.pth      --output_dir /path_to/oneref/rec_single_dataset_finetuning_large/unc;
## RefCOCO+ unc+
CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python -m torch.distributed.launch --nproc_per_node=8 --master_port 28888 --use_env eval.py --num_workers 4 --batch_size 128  --imsize 384 --max_query_len 64 --model beit3_large_patch16_384 --task grounding --dataset unc+     --eval_set val   --data_root /patch_to_image_data --split_root /path_to/ref_data_shuffled/single_dataset --eval_model /path_to/oneref/rec_single_dataset_finetuning_large/unc+/best_checkpoint.pth     --output_dir /path_to/oneref/rec_single_dataset_finetuning_large/unc+;
CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python -m torch.distributed.launch --nproc_per_node=8 --master_port 28888 --use_env eval.py --num_workers 4 --batch_size 128  --imsize 384 --max_query_len 64 --model beit3_large_patch16_384 --task grounding --dataset unc+     --eval_set testA --data_root /patch_to_image_data --split_root /path_to/ref_data_shuffled/single_dataset --eval_model /path_to/oneref/rec_single_dataset_finetuning_large/unc+/best_checkpoint.pth     --output_dir /path_to/oneref/rec_single_dataset_finetuning_large/unc+;
CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python -m torch.distributed.launch --nproc_per_node=8 --master_port 28888 --use_env eval.py --num_workers 4 --batch_size 128  --imsize 384 --max_query_len 64 --model beit3_large_patch16_384 --task grounding --dataset unc+     --eval_set testB --data_root /patch_to_image_data --split_root /path_to/ref_data_shuffled/single_dataset --eval_model /path_to/oneref/rec_single_dataset_finetuning_large/unc+/best_checkpoint.pth     --output_dir /path_to/oneref/rec_single_dataset_finetuning_large/unc+;
## gref_umd
CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python -m torch.distributed.launch --nproc_per_node=8 --master_port 28888 --use_env eval.py --num_workers 4 --batch_size 128  --imsize 384 --max_query_len 64 --model beit3_large_patch16_384 --task grounding --dataset gref_umd --eval_set val   --data_root /patch_to_image_data --split_root /path_to/ref_data_shuffled/single_dataset --eval_model /path_to/oneref/rec_single_dataset_finetuning_large/gref_umd/best_checkpoint.pth --output_dir /path_to/oneref/rec_single_dataset_finetuning_large/gref_umd;
CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python -m torch.distributed.launch --nproc_per_node=8 --master_port 28888 --use_env eval.py --num_workers 4 --batch_size 128  --imsize 384 --max_query_len 64 --model beit3_large_patch16_384 --task grounding --dataset gref_umd --eval_set test  --data_root /patch_to_image_data --split_root /path_to/ref_data_shuffled/single_dataset --eval_model /path_to/oneref/rec_single_dataset_finetuning_large/gref_umd/best_checkpoint.pth --output_dir /path_to/oneref/rec_single_dataset_finetuning_large/gref_umd;
## ReferItGame
CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python -m torch.distributed.launch --nproc_per_node=8 --master_port 28888 --use_env eval.py --num_workers 4 --batch_size 128  --imsize 384 --max_query_len 64 --model beit3_large_patch16_384 --task grounding --dataset referit  --eval_set val   --data_root /patch_to_image_data --split_root /path_to/ref_data_shuffled/single_dataset --eval_model /path_to/oneref/rec_single_dataset_finetuning_large/referit/best_checkpoint.pth  --output_dir /path_to/oneref/rec_single_dataset_finetuning_large/referit;
CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python -m torch.distributed.launch --nproc_per_node=8 --master_port 28888 --use_env eval.py --num_workers 4 --batch_size 128  --imsize 384 --max_query_len 64 --model beit3_large_patch16_384 --task grounding --dataset referit  --eval_set test  --data_root /patch_to_image_data --split_root /path_to/ref_data_shuffled/single_dataset --eval_model /path_to/oneref/rec_single_dataset_finetuning_large/referit/best_checkpoint.pth  --output_dir /path_to/oneref/rec_single_dataset_finetuning_large/referit;
## flickr
CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python -m torch.distributed.launch --nproc_per_node=8 --master_port 28888 --use_env eval.py --num_workers 4 --batch_size 128  --imsize 384 --max_query_len 64 --model beit3_large_patch16_384 --task grounding --dataset flickr   --eval_set val   --data_root /patch_to_image_data --split_root /path_to/ref_data_shuffled/single_dataset --eval_model /path_to/oneref/rec_single_dataset_finetuning_large/flickr/best_checkpoint.pth   --output_dir /path_to/oneref/rec_single_dataset_finetuning_large/flickr;
CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python -m torch.distributed.launch --nproc_per_node=8 --master_port 28888 --use_env eval.py --num_workers 4 --batch_size 128  --imsize 384 --max_query_len 64 --model beit3_large_patch16_384 --task grounding --dataset flickr   --eval_set test  --data_root /patch_to_image_data --split_root /path_to/ref_data_shuffled/single_dataset --eval_model /path_to/oneref/rec_single_dataset_finetuning_large/flickr/best_checkpoint.pth   --output_dir /path_to/oneref/rec_single_dataset_finetuning_large/flickr;

